var miniscroll={content:null,current:null,tracker:null,scrub:null,args:{},axis:"",scrollRect:{},dragging:false,startPos:{},touchPos:{},setTimeInterval:null,size:10,init:function(c,b){this.content=getId(c);this.args=b;this.size=(b.size==undefined)?10:b.size;this.addMiniScroll(this.content);if(isTouchDevice()){this.addMiniEvent(this.content,"touchstart",this.startTouch)}else{this.addMiniEvent(this.scrub,"mousedown",this.startEvent);this.addMiniEvent(this.content,"mousewheel",this.wheelEvent)}var a=[this.content,this.tracker,this.scrub];this.setTimeInterval=window.setInterval(this.updateScroll,100,this.args.scroll,a,this.size)},updateScroll:function(b,c,a){if(b=="x"){miniscroll.updateMiniScroll(c,"x",a);(c[1].offsetWidth==c[2].offsetWidth)?miniscroll.hide(c[1],c[2]):miniscroll.show(c[1],c[2])}else{miniscroll.updateMiniScroll(c,"y",a);(c[1].offsetHeight==c[2].offsetHeight)?miniscroll.hide(c[1],c[2]):miniscroll.show(c[1],c[2])}},hide:function(b,a){b.style.visibility="hidden";a.style.visibility="hidden"},show:function(b,a){b.style.visibility="visible";a.style.visibility="visible"},startTouch:function(b){var a=miniscroll;a.touchPos={x:this.scrollLeft+b.touches[0].clientX,y:this.scrollTop+b.touches[0].clientY};a.getCurrent(this);a.getAxis(a.tracker);a.addMiniEvent(this,"touchmove",a.moveTouch);a.addMiniEvent(this,"touchend",a.stopTouch);a.preventEvent(b)},moveTouch:function(c){var b=miniscroll;var d={x:this.scrollWidth-this.offsetWidth,y:this.scrollHeight-this.offsetHeight};var a={x:b.tracker.offsetWidth-b.scrub.offsetWidth,y:b.tracker.offsetHeight-b.scrub.offsetHeight};var f={x:(this.scrollLeft/d.x)*a.x,y:(this.scrollTop/d.y)*a.y};if(b.axis=="x"){this.scrollLeft=b.touchPos.x-c.touches[0].clientX;b.scrub.style.left=(f.x+this.offsetLeft)+"px"}else{this.scrollTop=b.touchPos.y-c.touches[0].clientY;b.scrub.style.top=(f.y+this.offsetTop)+"px"}b.preventEvent(c)},stopTouch:function(b){var a=miniscroll;a.removeMiniEvent(this,"touchmove",a.moveTouch);a.removeMiniEvent(this,"touchend",a.moveTouch)},startEvent:function(g){var d=miniscroll;var a=window.event?window.event:g;var f=window.event?g.srcElement:g.target;d.getCurrent(f.parentNode);d.getAxis(d.tracker);d.dragging=true;var h=d.current;var c=d.scrub;var b=d.tracker;var i=d.getMouseCords(g);d.startPos={x:i.x-parseInt(c.style.left),y:i.y-parseInt(c.style.top)};if(d.axis=="x"){d.scrollRect={x:h.offsetLeft,y:0,width:b.offsetWidth+h.offsetLeft-c.offsetWidth,height:0}}else{d.scrollRect={x:0,y:h.offsetTop,width:0,height:b.offsetHeight+h.offsetTop-c.offsetHeight}}d.addMiniEvent(document,"mousemove",d.moveEvent);d.addMiniEvent(document,"mouseup",d.stopEvent);d.preventEvent(a)},moveEvent:function(f){var d=miniscroll;if(d.dragging){var i=window.event?window.event:f;var g=d.getMouseCords(f);var a=d.current;var k=d.scrub;var j=d.tracker;var h={x:g.x-d.startPos.x,y:g.y-d.startPos.y};var c={x:(h.x/k.offsetWidth)*k.offsetWidth,y:(h.y/k.offsetHeight)*k.offsetHeight};var b={x:(j.offsetWidth-k.offsetWidth)+a.offsetLeft,y:(j.offsetHeight-k.offsetHeight)+a.offsetTop};if(d.axis=="x"){if(c.x<=a.offsetLeft){k.style.left=a.offsetLeft+"px"}else{if(c.x>=b.x){k.style.left=b.x+"px"}else{k.style.left=c.x+"px"}}a.scrollLeft=d.getScrollTo("x")}else{if(c.y<=a.offsetTop){k.style.top=a.offsetTop+"px"}else{if(c.y>=b.y){k.style.top=b.y+"px"}else{k.style.top=c.y+"px"}}a.scrollTop=d.getScrollTo("y")}d.preventEvent(i)}},wheelEvent:function(g){var f=miniscroll;var b=window.event?window.event:g;var i=-(b.detail?b.detail*(-120):b.wheelDelta);(i==0)?f.dragging=false:f.dragging=true;f.getCurrent(this);var d=f.scrub;var c=f.tracker;var a={x:this.scrollWidth-this.offsetWidth,y:this.scrollHeight-this.offsetHeight};var h={x:c.offsetWidth-d.offsetWidth,y:c.offsetHeight-d.offsetHeight};if(f.axis=="x"){this.scrollLeft+=i;d.style.left=this.offsetLeft+((this.scrollLeft/a.x)*h.x)+"px"}else{this.scrollTop+=i;d.style.top=this.offsetTop+((this.scrollTop/a.y)*h.y)+"px"}f.preventEvent(b)},stopEvent:function(c){var b=miniscroll;var a=window.event?window.event:c;b.dragging=false;b.removeMiniEvent(document,"mousemove",b.moveEvent);b.removeMiniEvent(document,"mouseup",b.stopEvent)},preventEvent:function(a){if(a.stopPropagation){a.stopPropagation()}if(a.preventDefault){a.preventDefault()}a.cancelBubble=true;a.cancel=true;a.returnValue=false;return false},getCurrent:function(b){var a=miniscroll;a.current=b;a.tracker=getId("tracker_"+a.current.id);a.scrub=getId("scrub_"+a.current.id)},getAxis:function(a){this.axis=(a.offsetWidth<a.offsetHeight)?"y":"x"},getMouseCords:function(b){var a=window.event?window.event:b;if(window.event){return{x:a.pageX,y:a.pageY}}else{return{x:a.clientX,y:a.clientY}}},getScrollTo:function(e){var f=this.current;var d=this.scrub;var c=this.tracker;if(e=="x"){var b=(d.offsetLeft-f.offsetLeft)/(c.offsetWidth-d.offsetWidth);return b*(f.scrollWidth-f.offsetWidth)}else{var a=(d.offsetTop-f.offsetTop)/(c.offsetHeight-d.offsetHeight);return a*(f.scrollHeight-f.offsetHeight)}},addMiniScroll:function(f){var e=miniscroll;var c=(e.args.size==undefined)?10:e.args.size;switch(e.args.scroll){case"x":var g=(f.offsetTop+f.offsetHeight)-c;e.addMiniTracker(f,f.offsetLeft,g,f.offsetWidth,c);var b=(f.offsetWidth*e.tracker.offsetWidth)/f.scrollWidth;e.addMiniScrub(f,f.offsetLeft,g,f.offsetWidth,c);break;case"y":var a=(f.offsetLeft+f.offsetWidth)-c;e.addMiniTracker(f,a,f.offsetTop,c,f.offsetHeight);var d=(f.offsetHeight*e.tracker.offsetHeight)/f.scrollHeight;e.addMiniScrub(f,a,f.offsetTop,c,d);break}},addMiniTracker:function(c,g,f,i,d){var e=miniscroll;var b=(e.args.alpha==undefined)?0.6:e.args.alpha;var a="tracker_"+c.id;var j=document.createElement("div");j.setAttribute("id",a);c.appendChild(j);e.tracker=getId(a);e.addCss(e.tracker,{left:g+"px",top:f+"px",width:i+"px",height:d+"px",position:"absolute",background:e.args.color});e.addOpacity(e.tracker,b);if(e.args.radius!=undefined){e.addRadius(e.tracker,e.args.radius)}},addMiniScrub:function(c,g,f,i,d){var e=miniscroll;var b=(e.args.scrubAlpha==undefined)?1:e.args.scrubAlpha;var a="scrub_"+c.id;var j=document.createElement("div");j.setAttribute("id",a);c.appendChild(j);e.scrub=getId(a);e.addCss(e.scrub,{left:g+"px",top:f+"px",width:i+"px",height:d+"px",position:"absolute",background:e.args.color});e.addOpacity(e.scrub,b);if(e.args.radius!=undefined){e.addRadius(e.scrub,e.args.radius)}},updateMiniScroll:function(g,e,k){switch(e){case"x":var i=g[0].offsetLeft;var h=(g[0].offsetTop+g[0].offsetHeight)-k;var a=g[0].offsetWidth;var j=k;var d=g[2].offsetLeft;var f=(g[0].offsetWidth*g[1].offsetWidth)/g[0].scrollWidth;miniscroll.updateMiniCss(g[1],[i,h,a,j]);miniscroll.updateMiniCss(g[2],[d,h,f,j]);break;case"y":var i=(g[0].offsetLeft+g[0].offsetWidth)-k;var h=g[0].offsetTop;var a=k;var j=g[0].offsetHeight;var c=g[2].offsetTop;var b=(g[0].offsetHeight*g[1].offsetHeight)/g[0].scrollHeight;miniscroll.updateMiniCss(g[1],[i,h,a,j]);miniscroll.updateMiniCss(g[2],[i,c,a,b]);break}},updateMiniCss:function(b,a){b.style.top=a[1]+"px";b.style.left=a[0]+"px";b.style.width=a[2]+"px";b.style.height=a[3]+"px"},addRadius:function(b,a){b.style.borderRadius=a+"px";b.style.MozBorderRadius=a+"px";b.style.WebkitBorderRadius=a+"px";b.style.KhtmlBorderRadius=a+"px"},addOpacity:function(c,b){c.style.filter="alpha(opacity="+(b*100)+")";c.style.opacity=b;c.style.MozOpacity=b;c.style.WebkitOpacity=b;c.style.KhtmlOpacity=b},addCss:function(b,a){b.style.top=a.top;b.style.left=a.left;b.style.width=a.width;b.style.height=a.height;b.style.position=a.position;b.style.backgroundColor=a.background},addMiniEvent:function(c,b,a){if(c.addEventListener){if(b=="mousewheel"){c.addEventListener("DOMMouseScroll",a,true)}c.addEventListener(b,a,true)}else{c.attachEvent("on"+b,a)}},removeMiniEvent:function(c,b,a){if(c.removeEventListener){if(b=="mousewheel"){c.removeEventListener("DOMMouseScroll",a,true)}else{c.removeEventListener(b,a,true)}}else{c.detachEvent("on"+b,a)}}};function getId(a){return document.getElementById(a)}function isTouchDevice(){try{document.createEvent("TouchEvent");return true}catch(a){return false}};