/*!
 * Miniscroll small plugin of scrollbar desktop and mobile
 *
 * @author Roger Luiz <http://rogerluizm.com.br/>
 *					  <http://miniscroll.rogerluizm.com.br>
 *
 * @copyright (c) 2011, 2012 <http://rogerluizm.com.br/>
 *
 * @version 1.2.1
 * 		update 1.2.1 - Touch evento adicionado, agora funciona para ipad, iphone e android 
 */
(function(d,a){var b={touchEvents:("ontouchstart" in a.documentElement)},c=function(e,f){this.type="";
this.is="static";this.target=this.getElement(e);this.container;this.tracker;this.thumb;this.thumb_delta=new Point(0,0);this.thumb_pos=new Point(0,0);this.touch=new Point(0,0);
this.settings=f;this.percent;this.scrolling=false;this.preventScrolling=false;this.initializing();};c.prototype.initializing=function(){this.buildScrollbar();
this.buildScrollbarTracker();this.buildScrolbarThumb();(!b.touchEvents)?this.setupEventHandler():this.setupTouchEvent();var e=this;d.setInterval(function(){e.update();
},10);};c.prototype.buildScrollbar=function(){var f=(this.target.id)?this.target.id:this.target.className;this.container=this.create(this.target,"div",{"class":"miniscroll-container",id:"miniscroll-"+f});
var e=this.settings.scrollbarSize?this.settings.scrollbarSize:this.offset(this.target).height;this.css(this.container,{position:"absolute",visibility:"hidden",width:this.settings.size+"px",height:e+"px",top:this.offset(this.target).top+"px",left:this.offset(this.target).left+(this.offset(this.target).width-this.settings.size)+"px",zIndex:999});
};c.prototype.buildScrollbarTracker=function(){this.tracker=this.create(this.container,"div",{"class":"miniscroll-tracker"});this.css(this.tracker,{width:this.settings.size+"px",height:this.offset(this.container).height+"px",backgroundColor:this.settings.trackerColor?this.settings.trackerColor:"#067f41"});
};c.prototype.buildScrolbarThumb=function(){this.thumb=this.create(this.container,"div",{"class":"miniscroll-thumb"});var f=(this.offset(this.container).height*this.offset(this.tracker).height)/this.target.scrollHeight;
var e=(this.settings.sizethumb===undefined||this.settings.sizethumb==="auto")?f:this.settings.sizethumb;this.css(this.thumb,{position:"absolute",top:0+"px",width:this.settings.size+"px",height:e+"px",backgroundColor:this.settings.thumbColor?this.settings.thumbColor:"#2AD47D"});
};c.prototype.setupEventHandler=function(){this.bind(this.thumb,"mousedown",this.onScrollThumbPress);this.bind(this.target,"mousewheel",this.onScrollThumbWheel);
};c.prototype.setupTouchEvent=function(){this.bind(this.target,"touchstart",this.onScrollTouchStart);this.bind(this.target,"touchmove",this.onScrollTouchMove);
};c.prototype.updateContainerPosition=function(){this.is=this.getCss(this.target,"position");if(this.is==="relative"||this.is==="absolute"){if(this.settings.axis==="y"){this.container.style.top=this.target.scrollTop+"px";
}else{this.container.style.left=this.target.scrollLeft+"px";}}};c.prototype.setScrubPosition=function(g){var h=this.offset(this.container).width,f=this.offset(this.container).height;
var e=this.offset(this.thumb).width,i=this.offset(this.thumb).height;this.thumb_pos=new Point(Math.round((h-e)*g),Math.round((f-i)*g));if(this.settings.axis==="y"){this.thumb.style.top=Math.round(this.thumb_pos.y)+"px";
}else{this.thumb.style.left=Math.round(this.thumb_pos.x)+"px";}};c.prototype.onScrollTouchStart=function(e){var f=e.touches[0];this.scrolling=true;this.touch=new Point(f.pageX,f.pageY);
this.bind(this.target,"touchend",this.onScrollTouchEnd);};c.prototype.onScrollTouchMove=function(e){var f=e.touches[0];e.preventDefault();var g=new Point(this.touch.x-f.pageX,this.touch.y-f.pageY);
this.touch=new Point(f.pageX,f.pageY);if(this.settings.axis==="y"){this.percent=this.target.scrollTop/(this.target.scrollHeight-this.target.offsetHeight);
this.setScrubPosition(this.percent);this.target.scrollTop=this.target.scrollTop+g.y;}else{this.percent=this.target.scrollLeft/(this.target.scrollWidth-this.target.offsetWidth);
this.setScrubPosition(this.percent);this.target.scrollLeft=this.target.scrollLeft+g.x;}this.updateContainerPosition();};c.prototype.onScrollTouchEnd=function(e){this.scrolling=false;
this.unbind(this.target,"touchend",this.onScrollTouchEnd);};c.prototype.onScrollThumbPress=function(e){e=e?e:d.event;this.stopEvent(e);this.scrolling=true;
this.thumb_delta=new Point(this.thumb_pos.x-this.mouse(e).x,this.thumb_pos.y-this.mouse(e).y);this.bind(a,"mousemove",this.onScrollThumbUpdate);this.bind(a,"mouseup",this.onScrollThumbRelease);
this.updateContainerPosition();};c.prototype.onScrollThumbUpdate=function(e){e=e?e:d.event;this.stopEvent(e);if(!this.scrolling){return false;}this.thumb_pos=new Point(this.mouse(e).x+this.thumb_delta.x,this.mouse(e).y+this.thumb_delta.y);
this.thumb_pos=new Point(Math.max(0,Math.min(this.container.offsetWidth-this.thumb.offsetWidth,this.thumb_pos.x)),Math.max(0,Math.min(this.container.offsetHeight-this.thumb.offsetHeight,this.thumb_pos.y)));
this.percent=new Point(this.thumb_pos.x/(this.container.offsetWidth-this.thumb.offsetWidth),this.thumb_pos.y/(this.container.offsetHeight-this.thumb.offsetHeight));
this.percent=new Point(Math.max(0,Math.min(1,this.percent.x)),Math.max(0,Math.min(1,this.percent.y)));this.thumb.style.top=Math.round(this.thumb_pos.y)+"px";
this.target.scrollTop=Math.round((this.target.scrollHeight-this.target.offsetHeight)*this.percent.y);this.updateContainerPosition();};c.prototype.onScrollThumbWheel=function(j){j=j?j:d.event;
if(!this.preventScrolling){this.stopEvent(j);}var h=j||d.event,g=[].slice.call(arguments,1),k=0,i=true,f=0,e=0;if(h.wheelDelta){k=h.wheelDelta/120;}if(h.detail){k=-h.detail/3;
}e=k;if(h.axis!==undefined&&h.axis===h.HORIZONTAL_AXIS){e=0;f=-1*k;}if(h.wheelDeltaY!==undefined){e=h.wheelDeltaY/120;}if(h.wheelDeltaX!==undefined){f=-1*h.wheelDeltaX/120;
}if(this.settings.axis==="y"){this.percent=this.target.scrollTop/(this.target.scrollHeight-this.target.offsetHeight);this.setScrubPosition(this.percent);
this.target.scrollTop=Math.round(this.target.scrollTop-(k*10));}if(this.percent>=1||this.percent<=0){this.preventScrolling=true;}else{this.preventScrolling=false;
}this.updateContainerPosition();};c.prototype.onScrollThumbRelease=function(e){e=e?e:d.event;this.stopEvent(e);this.scrolling=false;this.unbind(a,"mousemove",this.onScrollThumbUpdate);
this.unbind(a,"mouseup",this.onScrollThumbRelease);};c.prototype.update=function(){if(this.target.scrollHeight===this.offset(this.target).height){this.css(this.container,{visibility:"hidden"});
}else{this.css(this.container,{visibility:"visible"});}var e=this.settings.scrollbarSize?this.settings.scrollbarSize:this.offset(this.target).height;this.css(this.container,{position:"absolute",width:this.settings.size+"px",height:e+"px",top:this.offset(this.target).top+"px",left:this.offset(this.target).left+(this.offset(this.target).width-this.settings.size)+"px"});
this.css(this.tracker,{width:this.settings.size+"px",height:this.offset(this.container).height+"px"});var g=(this.offset(this.container).height*this.offset(this.tracker).height)/this.target.scrollHeight;
var f=(this.settings.sizethumb===undefined||this.settings.sizethumb==="auto")?g:this.settings.sizethumb;this.css(this.thumb,{height:f+"px"});if(this.settings.axis==="y"){this.percent=this.target.scrollTop/(this.target.scrollHeight-this.target.offsetHeight);
if(!this.scrolling){this.setScrubPosition(this.percent);}}this.updateContainerPosition();};c.prototype.getElement=function(f){var j,h=this;if(f===d||f===a||f==="body"||f==="body, html"){return a.body;
}if(typeof f==="string"||f instanceof String){var e=f.replace(/^\s+/,"").replace(/\s+$/,""),j;if(e.indexOf("#")>-1){this.type="id";var k=e.split("#");j=a.getElementById(k[1]);
}if(e.indexOf(".")>-1){this.type="class";var k=e.split("."),o=a.getElementsByTagName("*"),m=o.length,n=[],l=0;for(var g=0;g<m;g++){if(o[g].className&&o[g].className.match(new RegExp("(^|\\s)"+k[1]+"(\\s|$)"))){j=o[g];
}}}return j;}else{if(f instanceof jQuery){return f[0];}else{return f;}}};c.prototype.create=function(i,h,f){var e=a.createElement(h);if(f){for(var g in f){if(f.hasOwnProperty(g)){e.setAttribute(g,f[g]);
}}i.appendChild(e);}return e;};c.prototype.css=function(e,f){for(var g in f){if(g==="opacity"){e.style.filter="alpha(opacity="+(f[g]*100)+")";e.style.KhtmlOpacity=f[g];
e.style.MozOpacity=f[g];e.style.opacity=f[g];}else{e.style[g]=f[g];}}};c.prototype.getCss=function(f,g){var e;if(!d.getComputedStyle){if(a.defaultView&&a.defaultView.getComputedStyle){e=a.defaultView.getComputedStyle.getPropertyValue(g);
}else{if(f.currentStyle){e=f.currentStyle[g];}else{e=f.style[g];}}}else{e=d.getComputedStyle(f).getPropertyValue(g);}return e;};c.prototype.offset=function(f){var i=f.offsetTop,h=f.offsetLeft;
var e=f.offsetHeight;if(typeof f.offsetHeight==="undefined"){e=parseInt(this.getCss(f,"height"));}var g=f.offsetWidth;if(typeof f.offsetWidth==="undefined"){g=parseInt(this.getCss(f,"width"));
}return{top:i,left:h,width:g,height:e};};c.prototype.mouse=function(f){var e=0,g=0;if(f.pageX||f.pageY){e=f.pageX;g=f.pageY;}else{if(f.clientX||f.clientY){e=f.clientX+a.body.scrollLeft+a.documentElement.scrollLeft;
g=f.clientY+a.body.scrollTop+a.documentElement.scrollTop;}}return{x:e,y:g};};c.prototype.bind=function(g,f,i){var e=(/Firefox/i.test(navigator.userAgent))?"DOMMouseScroll":"mousewheel";
var h=this;if(g.addEventListener){if(f==="mousewheel"){g.addEventListener(e,function(j){i.call(h,j,this);},false);}else{g.addEventListener(f,function(j){i.call(h,j,this);
},false);}}else{if(g.attachEvent){g.attachEvent("on"+f,function(j){i.call(h,j,this);});}else{g["on"+f]=function(j){i.call(h,j,this);};}}};c.prototype.unbind=function(g,f,h){var e=(/Firefox/i.test(navigator.userAgent))?"DOMMouseScroll":"mousewheel";
if(g.addEventListener){if(f==="mousewheel"){g.removeEventListener(e,function(i){h.call(_this,i,this);},false);}else{g.removeEventListener(f,function(i){h.call(_this,i,this);
},false);}}else{if(g.attachEvent){g.detachEvent("on"+f,function(i){h.call(_this,i,this);});}else{g["on"+f]=null;}}};c.prototype.stopEvent=function(e){if(e.stopPropagation){e.stopPropagation();
}else{e.cancelBubble=true;}if(e.preventDefault){e.preventDefault();}else{e.returnValue=false;}};d.Miniscroll=c;})(window,document);var Point=(function(){a.prototype.x=0;
a.prototype.y=0;function a(b,c){this.x=b!=null?b:0;this.y=c!=null?c:0;}a.prototype.reset=function(){this.x=0;this.y=0;return this;};a.prototype.distanceTo=function(d){var c;
c=d.x-this.x;c=c*c;var e;e=d.y-this.y;e=e*e;return Math.sqrt(c+e);};a.prototype.angleTo=function(d){var c=this.x-d.x,e=this.y-d.y;return Math.atan2(c,e);
};return a;})();