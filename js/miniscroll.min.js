(function(a,b){function c(c,d){var e=this;this.target=b.getElementById(c);this.args=d||{};this.scrub=null;this.tracker=null;this.scrollbar=null;this.setDefaultArgs();this.createScrollbar();this.dragging=false;this.x=0;this.y=0;this.ty=0;this.tx=0;this.ratio={x:(this.target.scrollWidth-this.target.offsetWidth)/(this.tracker.offsetWidth-this.scrub.offsetWidth),y:(this.target.scrollHeight-this.target.offsetHeight)/(this.tracker.offsetHeight-this.scrub.offsetHeight)};this.point=null;this.scrollTime=null;this.scrollHeight=this.target.scrollHeight;if(this.isTouchDevice()){this.addEvent(this.target,"touchstart",function(a){e.onTouchStart(a)})}else{this.addEvent(this.scrub,"mousedown",function(a){e.stopEvent(a);e.onStartDrag(a)});this.addEvent(this.tracker,"mousedown",function(a){e.stopEvent(a);e.onTrackerMove(a)});this.addEvent(this.target,"mousewheel",function(a){e.stopEvent(a);e.onWheelDrag(a)})}this.scrollTime=a.setInterval(function(){e.onUpdate()},60)}c.prototype.createScrollbar=function(){var a=b.createElement("div");a.setAttribute("id",this.target.id+"_scroll");a.setAttribute("class","miniscrollContainer");if(this.args.axis==="y"){a.style.top=this.target.offsetTop+"px";a.style.left=this.target.offsetLeft+this.target.offsetWidth-this.args.size+"px";a.style.width=this.args.size+"px";a.style.height=this.target.offsetHeight+"px"}else{a.style.top=this.target.offsetTop+this.target.offsetHeight-this.args.size+"px";a.style.left=this.target.offsetLeft+"px";a.style.width=this.target.offsetWidth+"px";a.style.height=this.args.size+"px"}a.style.position="absolute";a.style.zIndex="9999";this.target.appendChild(a);this.scrollbar=b.getElementById(this.target.id+"_scroll");var c=b.createElement("div");c.setAttribute("id",this.target.id+"_tracker");if(this.args.axis==="y"){c.style.width=this.args.size+"px";c.style.height=this.target.offsetHeight+"px"}else{c.style.width=this.target.offsetWidth+"px";c.style.height=this.args.size+"px"}if(this.args.trackerColor!==undefined)c.style.backgroundColor=this.args.trackerColor;c.style.position="absolute";a.appendChild(c);this.tracker=b.getElementById(this.target.id+"_tracker");var d=this.target.offsetHeight*c.offsetHeight/this.target.scrollHeight;var e=this.target.offsetWidth*c.offsetWidth/this.target.scrollWidth;var f=b.createElement("div");f.setAttribute("id",this.target.id+"_scrub");if(this.args.axis==="y"){f.style.width=this.args.size+"px";if(this.args.handle===undefined||this.args.handle==="auto"){f.style.height=d+"px"}else{f.style.height=this.args.handle+"px"}}else{if(this.args.handle===undefined||this.args.handle==="auto"){f.style.width=e+"px"}else{f.style.width=this.args.handle+"px"}f.style.height=this.args.size+"px"}if(this.args.scrubColor!==undefined)f.style.backgroundColor=this.args.scrubColor;f.style.position="absolute";a.appendChild(f);this.scrub=b.getElementById(this.target.id+"_scrub")};c.prototype.setDefaultArgs=function(){if(this.args.axis===undefined)this.args.axis="y";if(this.args.size===undefined)this.args.size=12;if(this.args.handle===undefined)this.args.handle="auto";if(this.args.scrubColor===undefined)this.args.scrubColor="#000000";if(this.args.trackerColor===undefined)this.args.trackerColor="#ffffff"};c.prototype.onUpdate=function(){var a=this.target.offsetHeight*this.tracker.offsetHeight/this.target.scrollHeight;var b=this.target.offsetWidth*this.tracker.offsetWidth/this.target.scrollWidth;this.ratio={x:(this.target.scrollWidth-this.target.offsetWidth)/(this.tracker.offsetWidth-this.scrub.offsetWidth),y:(this.target.scrollHeight-this.target.offsetHeight)/(this.tracker.offsetHeight-this.scrub.offsetHeight)};if(this.args.axis==="y"){if(this.args.handle===undefined||this.args.handle==="auto"){this.scrub.style.height=a+"px"}if(this.tracker.offsetHeight>=this.target.scrollHeight){this.scrollbar.style.visibility="hidden"}else{this.scrollbar.style.visibility="visible"}if(this.target.scrollHeight>this.scrollHeight){var c=-this.target.scrollTop/(-this.target.scrollHeight+this.target.offsetHeight);this.scroll(0,c*(this.tracker.offsetHeight-this.scrub.offsetHeight))}}else{if(this.args.handle===undefined||this.args.handle==="auto"){this.scrub.style.width=b+"px"}if(this.tracker.offsetWidth>=this.target.scrollWidth){this.scrollbar.style.visibility="hidden"}else{this.scrollbar.style.visibility="visible"}if(this.target.scrollWidth>this.scrollWidth){var c=-this.target.scrollLeft/(-this.target.scrollWidth+this.target.offsetHeight);this.scroll(c*(this.tracker.offsetWidth-this.scrub.offsetWidth),0)}}};c.prototype.onTouchStart=function(a){var b=this;this.ty=a.targetTouches[0].pageY;this.tx=a.targetTouches[0].pageX;this.addEvent(this.target,"touchmove",function(a){b.onTouchMove(event)})};c.prototype.onTouchMove=function(a){a.preventDefault();var b=a.targetTouches[0].pageY;var c=a.targetTouches[0].pageX;this.scroll(this.args.axis==="x"?this.scrub.offsetLeft-(c-this.tx):0,this.args.axis==="y"?this.scrub.offsetTop-(b-this.ty):0);if(this.args.axis==="y")this.ty=b;if(this.args.axis==="x")this.tx=c};c.prototype.onStartDrag=function(c){var c=a.event||c;var d=this;this.dragging=true;this.point={x:c.clientX+b.body.scrollLeft-this.findOffsetLeft(this.scrub),y:c.clientY+b.body.scrollTop-this.findOffsetTop(this.scrub),offsetX:this.findOffsetLeft(this.tracker),offsetY:this.findOffsetTop(this.tracker)};this.addEvent(b,"mousemove",function(a){d.stopEvent(a);d.onMoveDrag(a)});this.addEvent(b,"mouseup",function(a){d.stopEvent(a);d.onStopDrag(a)})};c.prototype.onMoveDrag=function(c){var c=a.event||c;var d={x:c.clientX+b.body.scrollLeft-this.point.offsetX,y:c.clientY+b.body.scrollTop-this.point.offsetY};var e={x:d.x-this.point.x,y:d.y-this.point.y};if(this.dragging){this.scroll(e.x,e.y)}this.stopEvent(c)};c.prototype.onTrackerMove=function(c){var c=a.event||c;var d={x:c.clientX+b.body.scrollLeft,y:c.clientY+b.body.scrollTop};var e={x:d.x-this.findOffsetLeft(this.tracker)-this.scrub.offsetWidth/2,y:d.y-this.findOffsetTop(this.tracker)-this.scrub.offsetHeight/2};this.scroll(e.x,e.y)};c.prototype.onWheelDrag=function(b){var b=a.event||b;var c=Math.max(-1,Math.min(1,b.wheelDelta||-b.detail));this.scroll(this.x+ -c*20,this.y+ -c*20)};c.prototype.onStopDrag=function(a){this.dragging=false;this.removeEvent(b,"mousemove",function(a){});this.removeEvent(b,"mouseup",function(a){})};c.prototype.scroll=function(a,b){if(this.args.axis==="y"){if(b>this.tracker.offsetHeight-this.scrub.offsetHeight){b=this.tracker.offsetHeight-this.scrub.offsetHeight}if(b<0){b=0}this.scrub.style.top=b+"px";this.y=b}else{if(a>this.tracker.offsetWidth-this.scrub.offsetWidth){a=this.tracker.offsetWidth-this.scrub.offsetWidth}if(a<0){a=0}this.scrub.style.left=a+"px";this.x=a}this.contentTo()};c.prototype.scrollTo=function(a,b){this.scroll(a/this.ratio.x,b/this.ratio.y)};c.prototype.contentTo=function(){if(this.args.axis==="y"){this.target.scrollTop=Math.round(this.y*this.ratio.y)}else{this.target.scrollLeft=Math.round(this.x*this.ratio.x)}};c.prototype.findOffsetTop=function(a){var b=0;if(a.offsetParent){while(a.offsetParent){b+=a.offsetTop;a=a.offsetParent}}return b};c.prototype.findOffsetLeft=function(a){var b=0;if(a.offsetParent){while(a.offsetParent){b+=a.offsetLeft;a=a.offsetParent}}return b};c.prototype.addEvent=function(a,b,c){if(a.addEventListener){if(b==="mousewheel"){var d=/Firefox/i.test(navigator.userAgent)?"DOMMouseScroll":"mousewheel";a.addEventListener(d,c,false)}else{a.addEventListener(b,c,false)}this.addEvent=function(a,b,c){a.addEventListener(b,c,false)}}else if(a.attachEvent){a.attachEvent("on"+b,c);this.addEvent=function(a,b,c){a.attachEvent("on"+b,c)}}else{a["on"+b]=c;this.addEvent=function(a,b,c){a["on"+b]=c}}};c.prototype.removeEvent=function(a,b,c){if(a.addEventListener){if(b==="mousewheel"){var d=/Firefox/i.test(navigator.userAgent)?"DOMMouseScroll":"mousewheel";a.addEventListener(d,c,false)}else{a.removeEventListener(b,c,false)}this.removeEvent=function(a,b,c){a.removeEventListener(b,c,false)}}else if(a.attachEvent){a.detachEvent("on"+b,c);this.removeEvent=function(a,b,c){a.detachEvent("on"+b,c)}}else{a["on"+b]=null;this.removeEvent=function(a,b,c){a["on"+b]=null}}};c.prototype.stopEvent=function(a){if(a.stopPropagation){a.stopPropagation()}else{a.cancelBubble=true}if(a.preventDefault){a.preventDefault()}else{a.returnValue=false}};c.prototype.isTouchDevice=function(){return"ontouchstart"in a};a.Miniscroll=c})(window,document)